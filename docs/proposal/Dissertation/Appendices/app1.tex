% Note that the text in the [] brackets is the one that will
% appear in the table of contents, whilst the text in the {}
% brackets will appear in the main thesis.

%% APPENDIX HEADER ////////////////////////////////////////////////////////////////////////////////////

\chapter{Formulas for calculation of internal forces}
\label{app:fu}

%% APPENDIX CONTENT ///////////////////////////////////////////////////////////////////////////////////
In the pre-processing operations, the product of the stiffness coefficients, integration weighs and Jacobian determinant must be determined:
\begin{eqnarray}
	\mathcal{C}^P_{i,j} &=& \textbf{C}^P_{i,j}\circ\mathcal{W}^P,\,i,j=1,2,3,4,5,6\\
	\mathcal{A}^P_{i,j} &=& \textbf{A}^P_{i,j}\circ\mathcal{W}^P,\,i,j=1,2,6,\\
	\hat{\mathcal{A}}^P_{i,j} &=& \hat{\textbf{A}}^P_{i,j}\circ\mathcal{W}^P,\,i,j=4,5,\\
	\mathcal{B}^P_{i,j} &=& \textbf{B}^P_{i,j}\circ\mathcal{W}^P,\,i,j=1,2,6,\\
	\mathcal{D}^P_{i,j} &=& \textbf{D}^P_{i,j}\circ\mathcal{W}^P\, \mathrm{for}\, i,j=1,2,6,
\end{eqnarray}
and derivatives in global coordinates system:
\begin{eqnarray}
\frac{\partial \textbf{N}^P}{\partial x} &=& \textbf{N}^P_{,\xi}\circ\left(\mathcal{J}^P\right)^{1,1}_{\mathrm{inv}} + \textbf{N}^P_{,\eta}\circ\left(\mathcal{J}^P\right)^{2,1}_{\mathrm{inv}} + \textbf{N}^P_{,\zeta}\circ\left(\mathcal{J}^P\right)^{3,1}_{\mathrm{inv}},\\
\frac{\partial \textbf{N}^P}{\partial y} &=& \textbf{N}^P_{,\xi}\circ\left(\mathcal{J}^P\right)^{1,2}_{\mathrm{inv}} + \textbf{N}^P_{,\eta}\circ\left(\mathcal{J}^P\right)^{2,2}_{\mathrm{inv}} + \textbf{N}^P_{,\zeta}\circ\left(\mathcal{J}^P\right)^{3,2}_{\mathrm{inv}},\\
\frac{\partial \textbf{N}^P}{\partial z} &=& \textbf{N}^P_{,\xi}\circ\left(\mathcal{J}^P\right)^{1,3}_{\mathrm{inv}} + \textbf{N}^P_{,\eta}\circ\left(\mathcal{J}^P\right)^{2,3}_{\mathrm{inv}} + \textbf{N}^P_{,\zeta}\circ\left(\mathcal{J}^P\right)^{3,3}_{\mathrm{inv}}.
\end{eqnarray}

The determination of the internal force field is carried out in four steps for each moment.
In the first step, the displacement vectors are calculated, which in the case of \ac{3d} elements, are defined as:
\begin{eqnarray}
	\label{eq:strain}
	\boldsymbol{\epsilon}^P_{xx} &=& \frac{\partial \textbf{N}^P}{\partial x}\, \widehat{\textbf{u}}^P,\\
	\boldsymbol{\epsilon}^P_{yy} &=& \frac{\partial \textbf{N}^P}{\partial y}\, \widehat{\textbf{v}}^P,\\
	\boldsymbol{\epsilon}^P_{zz} &=& \frac{\partial \textbf{N}^P}{\partial z}\, \widehat{\textbf{w}}^P,\\
	\boldsymbol{\gamma}^P_{yz} &=& \frac{\partial \textbf{N}^P}{\partial y}\, \widehat{\textbf{w}}^P + \frac{\partial \textbf{N}^P}{\partial z}\, \widehat{\textbf{v}}^P,\\
	\boldsymbol{\gamma}^P_{xz} &=&  \frac{\partial \textbf{N}^P}{\partial x}\, \widehat{\textbf{w}}^P + \frac{\partial \textbf{N}^P}{\partial z}\, \widehat{\textbf{u}}^P,\\
	\boldsymbol{\gamma}^P_{xy} &=&  \frac{\partial \textbf{N}^P}{\partial x}\, \widehat{\textbf{v}}^P + \frac{\partial \textbf{N}^P}{\partial y}\, \widehat{\textbf{u}}^P.
\end{eqnarray}
Then the stress vectors are calculated as follows: 
\begin{eqnarray}
	\label{eq:stress}
	\boldsymbol{\sigma}^P_{xx} &=& \mathcal{C}^P_{1,1}\circ\boldsymbol{\epsilon}^P_{xx} +  \mathcal{C}^P_{1,2}\circ\boldsymbol{\epsilon}^P_{yy} + \mathcal{C}^P_{1,3}\circ\boldsymbol{\epsilon}^P_{zz} +
	\mathcal{C}^P_{1,6}\circ\boldsymbol{\gamma}^P_{xy},\\
	\boldsymbol{\sigma}^P_{yy} &=& \mathcal{C}^P_{2,1}\circ\boldsymbol{\epsilon}^P_{xx} +  \mathcal{C}^P_{2,2}\circ\boldsymbol{\epsilon}^P_{yy} + \mathcal{C}^P_{2,3}\circ\boldsymbol{\epsilon}^P_{zz} +
	\mathcal{C}^P_{2,6}\circ\boldsymbol{\gamma}^P_{xy},\\
	\boldsymbol{\sigma}^P_{zz} &=& \mathcal{C}^P_{3,1}\circ\boldsymbol{\epsilon}^P_{xx} +  \mathcal{C}^P_{3,2}\circ\boldsymbol{\epsilon}^P_{yy} + \mathcal{C}^P_{3,3}\circ\boldsymbol{\epsilon}^P_{zz} +
	\mathcal{C}^P_{3,6}\circ\boldsymbol{\gamma}^P_{xy},\\
	\boldsymbol{\tau}^P_{yz} &=& \mathcal{C}^P_{4,4}\circ\boldsymbol{\gamma}^P_{yz} +  \mathcal{C}^P_{4,5}\circ\boldsymbol{\gamma}^P_{xz},\\
	\boldsymbol{\tau}^P_{xz} &=& \mathcal{C}^P_{5,4}\circ\boldsymbol{\gamma}^P_{yz} +  \mathcal{C}^P_{5,5}\circ\boldsymbol{\gamma}^P_{xz},\\
	\boldsymbol{\tau}^P_{xy} &=& \mathcal{C}^P_{1,6}\circ\boldsymbol{\epsilon}^P_{xx} +  \mathcal{C}^P_{2,6}\circ\boldsymbol{\epsilon}^P_{yy} + \mathcal{C}^P_{3,6}\circ\boldsymbol{\epsilon}^P_{zz} +
	\mathcal{C}^P_{6,6}\circ\boldsymbol{\gamma}^P_{xy}.
\end{eqnarray}
The next step is calculation of the effective global forces for each element along x, y and z, directions, respectively.
\begin{eqnarray}
	\label{eq:force_3d}
	\textbf{F}^P_{x} &=& 
	\left( \frac{\partial \textbf{N}^P}{\partial x}\right)^T \boldsymbol{\sigma}^P_{xx} +
	\left( \frac{\partial \textbf{N}^P}{\partial y}\right)^T \boldsymbol{\sigma}^P_{xy} +
	\left( \frac{\partial \textbf{N}^P}{\partial z}\right)^T \boldsymbol{\sigma}^P_{xz},\\
	\textbf{F}^P_{y} &=&  
	\left( \frac{\partial \textbf{N}^P}{\partial x}\right)^T \boldsymbol{\sigma}^P_{xy} +
	\left( \frac{\partial \textbf{N}^P}{\partial y}\right)^T \boldsymbol{\sigma}^P_{yy} +
	\left( \frac{\partial \textbf{N}^P}{\partial z}\right)^T \boldsymbol{\sigma}^P_{yz},\\
	\textbf{F}^P_{z} &=&  
	\left( \frac{\partial \textbf{N}^P}{\partial x}\right)^T \boldsymbol{\sigma}^P_{xz} +
	\left( \frac{\partial \textbf{N}^P}{\partial y}\right)^T \boldsymbol{\sigma}^P_{yz} +
	\left( \frac{\partial \textbf{N}^P}{\partial z}\right)^T \boldsymbol{\sigma}^P_{zz}.
\end{eqnarray}
Finally, the element wise forces vectors are assembly to global vectors according to Eq. (\ref{eq:Fmatrix}) and Eq. (\ref{eq:Fsum}).

Similarly, internal forces are determined for \ac{2d} elements, with displacement vectors defined as:
\begin{eqnarray}
	\label{eq:strain_b}
	\boldsymbol{\epsilon}^P_{b1} &=& \frac{\partial \textbf{N}^P}{\partial x}\, \widehat{\textbf{u}}^P_0,\\
	\boldsymbol{\epsilon}^P_{b2} &=& \frac{\partial \textbf{N}^P}{\partial y}\, \widehat{\textbf{v}}^P_0,\\
	\boldsymbol{\epsilon}^P_{b3} &=& \frac{\partial \textbf{N}^P}{\partial y}\, \widehat{\textbf{u}}^P_0 +
	\frac{\partial \textbf{N}^P}{\partial x}\, \widehat{\textbf{v}}^P_0,\\
	\boldsymbol{\epsilon}^P_{b4} &=& \frac{\partial \textbf{N}^P}{\partial x}\, \widehat{\boldsymbol{\varphi}}^P_x,\\
	\boldsymbol{\epsilon}^P_{b5} &=& \frac{\partial \textbf{N}^P}{\partial y}\, \widehat{\boldsymbol{\varphi}}^P_y,\\
	\boldsymbol{\epsilon}^P_{b6} &=& \frac{\partial \textbf{N}^P}{\partial x}\, \widehat{\boldsymbol{\varphi}}^P_y + 
	\frac{\partial \textbf{N}^P}{\partial y}\, \widehat{\boldsymbol{\varphi}}^P_x,\\
	\boldsymbol{\epsilon}^P_{s1} &=& \frac{\partial \textbf{N}^P}{\partial x}\, \widehat{\textbf{w}}^P_0 - \widehat{\boldsymbol{\varphi}}^P_x,\\
	\boldsymbol{\epsilon}^P_{s2} &=& \frac{\partial \textbf{N}^P}{\partial y}\, \widehat{\textbf{w}}^P_0 -\widehat{\boldsymbol{\varphi}}^P_y,
\end{eqnarray}
the stress vectors:
\begin{eqnarray}
	\label{eq:stress_b}
	\boldsymbol{\sigma}^P_{b1} = \mathcal{A}^P_{1,1}\circ\boldsymbol{\epsilon}^P_{b1} +  \mathcal{A}^P_{1,2}\circ\boldsymbol{\epsilon}^P_{b2} + \mathcal{A}^P_{1,6}\circ\boldsymbol{\epsilon}^P_{b3} +
	\mathcal{B}^P_{1,1}\circ\boldsymbol{\epsilon}^P_{b4} +  \mathcal{B}^P_{1,2}\circ\boldsymbol{\epsilon}^P_{b5} + \mathcal{B}^P_{1,6}\circ\boldsymbol{\epsilon}^P_{b6},\\	
	\boldsymbol{\sigma}^P_{b1} = \mathcal{A}^P_{1,2}\circ\boldsymbol{\epsilon}^P_{b1} +  \mathcal{A}^P_{2,2}\circ\boldsymbol{\epsilon}^P_{b2} + \mathcal{A}^P_{2,6}\circ\boldsymbol{\epsilon}^P_{b3} +
	\mathcal{B}^P_{1,2}\circ\boldsymbol{\epsilon}^P_{b4} +  \mathcal{B}^P_{2,2}\circ\boldsymbol{\epsilon}^P_{b5} + \mathcal{B}^P_{2,6}\circ\boldsymbol{\epsilon}^P_{b6},\\
	\boldsymbol{\sigma}^P_{b1} = \mathcal{A}^P_{1,6}\circ\boldsymbol{\epsilon}^P_{b1} +  \mathcal{A}^P_{2,6}\circ\boldsymbol{\epsilon}^P_{b2} + \mathcal{A}^P_{6,6}\circ\boldsymbol{\epsilon}^P_{b3} +
	\mathcal{B}^P_{1,6}\circ\boldsymbol{\epsilon}^P_{b4} +  \mathcal{B}^P_{2,6}\circ\boldsymbol{\epsilon}^P_{b5} + \mathcal{B}^P_{6,6}\circ\boldsymbol{\epsilon}^P_{b6},\\
	\boldsymbol{\sigma}^P_{b1} = \mathcal{B}^P_{1,1}\circ\boldsymbol{\epsilon}^P_{b1} +  \mathcal{B}^P_{1,2}\circ\boldsymbol{\epsilon}^P_{b2} + \mathcal{B}^P_{1,6}\circ\boldsymbol{\epsilon}^P_{b3} +
	\mathcal{D}^P_{1,1}\circ\boldsymbol{\epsilon}^P_{b4} +  \mathcal{D}^P_{1,2}\circ\boldsymbol{\epsilon}^P_{b5} + \mathcal{D}^P_{1,6}\circ\boldsymbol{\epsilon}^P_{b6},\\
	\boldsymbol{\sigma}^P_{b1} = \mathcal{B}^P_{1,2}\circ\boldsymbol{\epsilon}^P_{b1} +  \mathcal{B}^P_{2,2}\circ\boldsymbol{\epsilon}^P_{b2} + \mathcal{B}^P_{2,6}\circ\boldsymbol{\epsilon}^P_{b3} +
	\mathcal{D}^P_{1,2}\circ\boldsymbol{\epsilon}^P_{b4} +  \mathcal{D}^P_{2,2}\circ\boldsymbol{\epsilon}^P_{b5} + \mathcal{D}^P_{2,6}\circ\boldsymbol{\epsilon}^P_{b6},\\
	\boldsymbol{\sigma}^P_{b1} = \mathcal{B}^P_{1,6}\circ\boldsymbol{\epsilon}^P_{b1} +  \mathcal{B}^P_{2,6}\circ\boldsymbol{\epsilon}^P_{b2} + \mathcal{B}^P_{6,6}\circ\boldsymbol{\epsilon}^P_{b3} +
	\mathcal{D}^P_{1,6}\circ\boldsymbol{\epsilon}^P_{b4} +  \mathcal{D}^P_{2,6}\circ\boldsymbol{\epsilon}^P_{b5} + \mathcal{D}^P_{6,6}\circ\boldsymbol{\epsilon}^P_{b6},\\
	\boldsymbol{\sigma}^P_{s1} = \hat{\mathcal{A}}^P_{4,4}\circ\boldsymbol{\epsilon}^P_{s1} +  \hat{\mathcal{A}}^P_{4,5}\circ\boldsymbol{\epsilon}^P_{s2},\\ \boldsymbol{\sigma}^P_{s1} = \hat{\mathcal{A}}^P_{4,5}\circ\boldsymbol{\epsilon}^P_{s1} +  \hat{\mathcal{A}}^P_{5,5}\circ\boldsymbol{\epsilon}^P_{s2},
\end{eqnarray}
and the internal forces:
\begin{eqnarray}
	\label{eq:force_2d}
	\textbf{F}^P_{x} &=& 
	\left( \frac{\partial \textbf{N}^P}{\partial x}\right)^T \boldsymbol{\sigma}^P_{b1} +
	\left( \frac{\partial \textbf{N}^P}{\partial y}\right)^T \boldsymbol{\sigma}^P_{b3},\\
	\textbf{F}^P_{y} &=& 
	\left( \frac{\partial \textbf{N}^P}{\partial x}\right)^T \boldsymbol{\sigma}^P_{b3} +
	\left( \frac{\partial \textbf{N}^P}{\partial y}\right)^T \boldsymbol{\sigma}^P_{b2},\\
	\textbf{F}^P_{z} &=& 
	\left( \frac{\partial \textbf{N}^P}{\partial x}\right)^T \boldsymbol{\sigma}^P_{s1} +
	\left( \frac{\partial \textbf{N}^P}{\partial y}\right)^T \boldsymbol{\sigma}^P_{s2},\\
	\textbf{M}^P_{x} &=& 
	-\left( \frac{\partial \textbf{N}^P}{\partial x}\right)^T \boldsymbol{\sigma}^P_{b4} -
	\left( \frac{\partial \textbf{N}^P}{\partial y}\right)^T \boldsymbol{\sigma}^P_{b6} - \boldsymbol{\sigma}^P_{s1},\\
	\textbf{M}^P_{y} &=& 
	-\left( \frac{\partial \textbf{N}^P}{\partial x}\right)^T \boldsymbol{\sigma}^P_{b6} -
	\left( \frac{\partial \textbf{N}^P}{\partial y}\right)^T \boldsymbol{\sigma}^P_{b5} - \boldsymbol{\sigma}^P_{s2}.
\end{eqnarray}